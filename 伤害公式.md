# 星痕共鸣伤害计算知识库

本文档旨在提供一份通用的星痕共鸣伤害计算指南，帮助玩家理解伤害构成的核心要素和计算逻辑。本文基于对现有代码和社区理论的分析，剥离了特定职业的特殊机制，以呈现一套普适的伤害计算框架。

## 一、伤害计算核心公式

最终伤害的计算可以被简化为以下几个核心部分的乘积：

**最终伤害 = 基础伤害 × 技能效果 × 通用增伤区 × 独立增伤区**

下面将对每个部分进行详细拆解。

---

## 二、伤害构成详解

### 1. 基础伤害

基础伤害是所有伤害计算的起点，由以下三部分构成：

-   **面板攻击力**：主要由角色的主属性（力量/敏捷/智力）按特定系数转化而来，并包含武器、模组等提供的固定攻击力。
-   **精炼攻击力**：通过装备精炼获得的攻击力。
-   **元素攻击力**：通常由天赋、模组等提供，这部分伤害在计算时 **不** 受到常规的物理或魔法防御减免。

**基础伤害公式**：
```
基础伤害 = (面板攻击力 × 防御减免系数) + 精炼攻击力 + 元素攻击力
```

**防御减免系数**：
这是一个非线性函数，怪物等级越高，防御力越强，减免效果越明显。通用公式为：
```
防御减免系数 = 基础防御值 / (怪物防御力 + 基础防御值)
```
*（注：基础防御值在代码中通常为一个常量，例如 `6500`）*

### 2. 技能效果

技能效果直接决定了基础伤害能被放大多少，主要包含两个部分：

-   **技能倍率 (%)**：技能说明中最重要的百分比数值，决定了技能的基础伤害放大系数。
-   **附加伤害**：一个固定的数值，直接加在技能倍率计算之后的结果上。

**技能伤害计算**：
```
技能伤害 = (基础伤害 × 技能倍率) + 附加伤害
```

### 3. 通用增伤区

通用增伤区包含了多种类型的伤害加成，这些加成效果在计算时 **以加算形式** 汇总。这意味着，同类加成堆得越高，其边际效益会递减。

**通用增伤区包括**：
-   近距离伤害加成 (%)
-   首领/精英伤害加成 (%)
-   易伤效果 (%)
-   技能伤害加成 (%)
-   物理/魔法伤害加成 (%)

**通用增伤乘数**：
```
通用增伤乘数 = 1 + (近战伤害% + 首领伤害% + 易伤% + 技能伤害% + 物理伤害% + ...) / 100
```

### 4. 独立增伤区

独立增伤区由多个 **相互独立** 的乘区构成。这些乘区之间以 **乘算** 方式结合，因此提升其中任何一个，都能带来稳定的伤害增长，且不存在边际效益递减的问题。

**主要的独立增伤区**：

-   **元素伤害加成区**：
    -   由天赋、模组等提供的元素伤害加成。
    -   `元素增伤乘数 = 1 + (元素伤害加成% / 100)`

-   **全能区**：
    -   由“全能”这一进阶属性提供，其转化率并非线性。
    -   `全能增伤乘数 = 1 + (全能值 × 0.0035)` *(这是一个近似值，实际转化曲线复杂)*

-   **暴击区**：
    -   当攻击发生暴击时，此乘区生效。
    -   `暴击伤害乘数 = 1 + (暴击伤害% / 100)`

---

## 三、期望伤害计算

考虑到暴击的概率性，期望伤害是衡量角色持续输出能力的关键指标。

**期望伤害公式**：
```
期望伤害 = (非暴击伤害 × (1 - 暴击率)) + (暴击伤害 × 暴击率)
```
其中：
-   **非暴击伤害** = 基础伤害 × 技能效果 × 通用增伤区 × (除暴击外的独立增伤区)
-   **暴击伤害** = 非暴击伤害 × 暴击伤害乘数
-   **暴击率** = 基础暴击率 + (暴击值 / (暴击值 + 常数))

---

## 四、总结

理解伤害计算的核心是区分 **加算** 与 **乘算**。

-   **通用增伤区（加算）**：同类属性叠加时，收益会递减。
-   **独立增伤区（乘算）**：不同乘区的属性均衡发展，才能最大化伤害输出。

通过本指南，玩家可以更科学地评估属性收益，做出更优的装备和天赋搭配选择。
